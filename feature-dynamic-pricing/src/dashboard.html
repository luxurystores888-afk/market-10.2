<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dynamic Pricing Dashboard - Real-Time</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: white;
      padding: 20px;
    }
    .container { max-width: 1400px; margin: 0 auto; }
    .header {
      text-align: center;
      margin-bottom: 40px;
      padding: 20px;
      background: rgba(6, 182, 212, 0.1);
      border-radius: 15px;
      border: 2px solid #06b6d4;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .stat-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(6, 182, 212, 0.3);
      border-radius: 10px;
      padding: 20px;
    }
    .stat-value {
      font-size: 36px;
      font-weight: bold;
      color: #06b6d4;
      margin: 10px 0;
    }
    .stat-label {
      color: #94a3b8;
      font-size: 14px;
      text-transform: uppercase;
    }
    .chart-container {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(6, 182, 212, 0.3);
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
      animation: pulse 2s infinite;
    }
    .status-online { background: #10b981; }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .update-time {
      color: #94a3b8;
      font-size: 12px;
      text-align: center;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>âš¡ Dynamic Pricing Dashboard</h1>
      <p>Real-Time AI-Driven Price Optimization</p>
      <p style="margin-top: 10px;">
        <span class="status-indicator status-online"></span>
        <span id="status">System Online</span>
      </p>
    </div>

    <!-- Key Metrics -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-label">Revenue Impact</div>
        <div class="stat-value" id="revenueImpact">+$0</div>
        <div style="color: #10b981; font-size: 14px;">â†‘ vs. static pricing</div>
      </div>

      <div class="stat-card">
        <div class="stat-label">Average Margin</div>
        <div class="stat-value" id="avgMargin">0%</div>
        <div style="color: #94a3b8; font-size: 14px;">Across all products</div>
      </div>

      <div class="stat-card">
        <div class="stat-label">Conversion Rate</div>
        <div class="stat-value" id="conversionRate">0%</div>
        <div style="color: #06b6d4; font-size: 14px;">Purchase rate</div>
      </div>

      <div class="stat-card">
        <div class="stat-label">Products Optimized</div>
        <div class="stat-value" id="productsOptimized">0</div>
        <div style="color: #94a3b8; font-size: 14px;">Active pricing</div>
      </div>

      <div class="stat-card">
        <div class="stat-label">Model Accuracy</div>
        <div class="stat-value" id="modelAccuracy">0%</div>
        <div style="color: #8b5cf6; font-size: 14px;">Prediction accuracy</div>
      </div>

      <div class="stat-card">
        <div class="stat-label">API Response Time</div>
        <div class="stat-value" id="apiResponseTime">0ms</div>
        <div style="color: #94a3b8; font-size: 14px;">Average latency</div>
      </div>
    </div>

    <!-- Charts -->
    <div class="chart-container">
      <h3 style="margin-bottom: 20px;">ðŸ“ˆ Revenue Impact (Last 24 Hours)</h3>
      <canvas id="revenueChart"></canvas>
    </div>

    <div class="chart-container">
      <h3 style="margin-bottom: 20px;">ðŸ’° Margin Optimization (Last 24 Hours)</h3>
      <canvas id="marginChart"></canvas>
    </div>

    <div class="chart-container">
      <h3 style="margin-bottom: 20px;">âš¡ Price Changes Distribution</h3>
      <canvas id="priceChangesChart"></canvas>
    </div>

    <p class="update-time">
      Last updated: <span id="lastUpdate">Never</span> | 
      Auto-refreshes every 30 seconds
    </p>
  </div>

  <script>
    // Configuration
    const API_URL = 'http://localhost:3002/api/pricing';
    
    // Charts
    let revenueChart, marginChart, priceChangesChart;

    // Initialize dashboard
    async function initDashboard() {
      // Create charts
      createCharts();
      
      // Initial data fetch
      await updateDashboard();
      
      // Auto-refresh every 30 seconds
      setInterval(updateDashboard, 30000);
    }

    // Update all dashboard data
    async function updateDashboard() {
      try {
        const response = await fetch(`${API_URL}/stats`);
        const data = await response.json();

        // Update stats
        document.getElementById('revenueImpact').textContent = 
          `+$${(data.metrics?.revenueIncrease || 0).toLocaleString()}`;
        document.getElementById('avgMargin').textContent = 
          `${(data.metrics?.averageMargin || 0).toFixed(1)}%`;
        document.getElementById('conversionRate').textContent = 
          `${(data.metrics?.conversionRate || 0).toFixed(2)}%`;
        document.getElementById('productsOptimized').textContent = 
          data.model?.statesLearned || 0;
        document.getElementById('modelAccuracy').textContent = 
          `${(data.performance?.successRate || 0).toFixed(1)}%`;
        document.getElementById('apiResponseTime').textContent = 
          `${Math.round(data.performance?.avgResponseTime || 0)}ms`;

        // Update charts
        updateCharts(data);

        // Update timestamp
        document.getElementById('lastUpdate').textContent = 
          new Date().toLocaleTimeString();
        document.getElementById('status').textContent = 'System Online';

      } catch (error) {
        console.error('Dashboard update failed:', error);
        document.getElementById('status').textContent = 'System Offline';
      }
    }

    // Create charts
    function createCharts() {
      const chartConfig = {
        type: 'line',
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { labels: { color: 'white' } }
          },
          scales: {
            y: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } },
            x: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } }
          }
        }
      };

      revenueChart = new Chart(document.getElementById('revenueChart'), {
        ...chartConfig,
        data: {
          labels: [],
          datasets: [{
            label: 'Revenue ($)',
            data: [],
            borderColor: '#06b6d4',
            backgroundColor: 'rgba(6, 182, 212, 0.1)',
            tension: 0.4
          }]
        }
      });

      marginChart = new Chart(document.getElementById('marginChart'), {
        ...chartConfig,
        data: {
          labels: [],
          datasets: [{
            label: 'Margin (%)',
            data: [],
            borderColor: '#10b981',
            backgroundColor: 'rgba(16, 185, 129, 0.1)',
            tension: 0.4
          }]
        }
      });

      priceChangesChart = new Chart(document.getElementById('priceChangesChart'), {
        type: 'bar',
        data: {
          labels: ['-10%', '-5%', '0%', '+5%', '+10%', '+15%', '+20%'],
          datasets: [{
            label: 'Price Changes',
            data: [5, 12, 15, 18, 20, 15, 10],
            backgroundColor: [
              '#ef4444', '#f97316', '#eab308',
              '#06b6d4', '#10b981', '#8b5cf6', '#ec4899'
            ]
          }]
        },
        options: {
          responsive: true,
          plugins: { legend: { labels: { color: 'white' } } },
          scales: {
            y: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } },
            x: { ticks: { color: 'white' }, grid: { color: 'rgba(255,255,255,0.1)' } }
          }
        }
      });
    }

    // Update charts with new data
    function updateCharts(data) {
      // Simulate time-series data (in production, get from API)
      const now = new Date();
      const timeLabels = Array.from({length: 24}, (_, i) => {
        const d = new Date(now);
        d.setHours(d.getHours() - (23 - i));
        return d.getHours() + ':00';
      });

      // Revenue data (simulated)
      const revenueData = Array.from({length: 24}, () => 
        10000 + Math.random() * 5000
      );

      revenueChart.data.labels = timeLabels;
      revenueChart.data.datasets[0].data = revenueData;
      revenueChart.update();

      // Margin data
      const marginData = Array.from({length: 24}, () => 
        30 + Math.random() * 20
      );

      marginChart.data.labels = timeLabels;
      marginChart.data.datasets[0].data = marginData;
      marginChart.update();
    }

    // Initialize on load
    document.addEventListener('DOMContentLoaded', initDashboard);
  </script>
</body>
</html>

